.globl constructor_external
DROP
PUSHINT $constructor$
CALL 1
.globl constructor
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; Function: constructor
NEWDICT
NEWC STSLICE ENDC
POPROOT
PUSHINT 0
;; assign m_accumulator
NEWC STU 256 ENDC CTOS
PUSHINT 0
PUSHROOT CTOS
PUSHINT 256
DICTUSET
NEWC STSLICE ENDC
POPROOT
;; return
RET
.globl fact
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; Function: fact
;; param: n
;; if
;; n
;; stack=1
DUP
PUSHINT 0
;; ==
EQUAL
PUSHCONT {
	PUSHINT 1
	;; return
	POP s1
	RET
}
IFJMP
;; n
;; stack=1
DUP
;; n
;; stack=2
PUSH s1
PUSHINT 1
;; -
SUB
PUSHINT $fact$
CALL 1
;; *
MUL
;; return
POP s1
RET
.globl main_external
LDU 16
DROP
PUSHINT $main$
CALL 1
.globl main
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; Function: main
;; param: n
;; m_accumulator
;; stack=1
PUSHINT 0
PUSHROOT CTOS
PUSHINT 256
DICTUGET
PUSHCONT { LDU 256 ENDS }
PUSHCONT { PUSHINT 0 }
IFELSE
;; n
;; stack=2
PUSH s1
PUSHINT $fact$
CALL 1
;; +
ADD
;; assign m_accumulator
NEWC STU 256 ENDC CTOS
PUSHINT 0
PUSHROOT CTOS
PUSHINT 256
DICTUSET
NEWC STSLICE ENDC
POPROOT
;; m_accumulator
;; stack=1
PUSHINT 0
PUSHROOT CTOS
PUSHINT 256
DICTUGET
PUSHCONT { LDU 256 ENDS }
PUSHCONT { PUSHINT 0 }
IFELSE
;; return
POP s1
RET
